allprojects {
    rootProject.evaluationDependsOnChildren()

    pluginManager.withPlugin('maven-publish') {
        rootProject.apply plugin: 'io.github.gradle-nexus.publish-plugin'

        project.file("${rootProject.buildDir}/publish-maven-central.flag").text = ''
    }

    pluginManager.withPlugin('io.github.gradle-nexus.publish-plugin') {
        nexusPublishing {
            repositories {
                sonatype()
            }
        }
    }
}
