if (project.isBuildSrcProject) {
    return
}

allprojects {
    String gnupgEnable = findProperty('signing.gnupg.enable')?.toString()
    String signingKey = findProperty('signing.key')?.toString()
    if (gnupgEnable || signingKey) {
        apply plugin: 'signing'
    }

    pluginManager.withPlugin('signing') {
        signing {
            if (gnupgEnable) {
                useGpgCmd()

            } else {
                String signingKeyId = findProperty('signing.keyId')?.toString()
                if (signingKeyId) {
                    useInMemoryPgpKeys(
                        signingKeyId,
                        signingKey,
                        findProperty('signing.password')?.toString()
                    )

                } else {
                    useInMemoryPgpKeys(
                        signingKey,
                        findProperty('signing.password')?.toString()
                    )
                }
            }
        }
    }
}
